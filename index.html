<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- ini penting buat responsif -->
  <title>Verifikasi Sertifikat</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f2f2f2;
      margin: 0;
      padding: 0;
    }

    .container {
      padding: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }

    .result {
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 12px rgba(0,0,0,0.1);
      width: 100%;
      max-width: 480px;
      text-align: left;
    }

    .result b {
      display: inline-block;
      width: 120px;
    }

    .result a {
      display: inline-block;
      margin-top: 10px;
      text-decoration: none;
      color: #007BFF;
    }

    .error {
      color: red;
      font-weight: bold;
    }

    @media (max-width: 480px) {
      .result {
        padding: 16px;
        font-size: 16px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div id="hasil" class="result">üîÑ Sedang memuat data...</div>
  </div>

  <script>
    const kode = new URLSearchParams(window.location.search).get('kode');
    const hasil = document.getElementById('hasil');

    if (!kode) {
      hasil.innerHTML = '‚ùå <span class="error">Kode tidak diberikan.</span><br>Gunakan URL seperti <b>?kode=1VSMS2025F001</b>';
    } else {
      fetch('https://docs.google.com/spreadsheets/d/e/2PACX-1vToiXzfx8AI4KHnuKNSSvMGqa5yzLPy2EYo27qkiePBRgSmHS-L4KXpfj0coMt6U5Jtz7X8sOvJhcSj/pub?output=csv')
        .then(response => response.text())
        .then(csv => {
          const rows = csv.split('\n').slice(1); // buang header
          const data = rows.map(row => row.split(','));

          const cocok = data.find(r => r[0].trim() === kode);
          if (cocok) {
            const link = cocok[5]?.trim();
            const linkHTML = link && link.startsWith('http') ? `<a href="${link}" target="_blank">üîó Lihat Sertifikat</a>` : '';

            hasil.innerHTML = `
              ‚úÖ Sertifikat ditemukan!<br><br>
              <b>Nama:</b> ${cocok[1]}<br><br>
              <b>Kode:</b> ${cocok[2]}<br><br>
              <b>Pelatihan:</b> ${cocok[3]}<br><br>
              <b>Tanggal:</b> ${cocok[4]}<br><br>
              ${linkHTML}
            `;
          } else {
            hasil.innerHTML = '‚ùå <span class="error">Sertifikat tidak ditemukan.</span><br>Periksa kode Anda.';
          }
        })
        .catch(error => {
          hasil.innerHTML = '‚ùå <span class="error">Gagal mengambil data.</span>';
          console.error(error);
        });
    }
  </script>
</body>
</html>
